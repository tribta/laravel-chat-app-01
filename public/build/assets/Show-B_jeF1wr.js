import{j as s,r as n}from"./app-CFIlwbgl.js";import{C as h,a as p}from"./ConversationList-tgsGIxO7.js";/* empty css            */function x({conversationId:t}){const r=useRef(null),{data:o,setData:a,post:i,processing:e,reset:c,clearErrors:l}=useForm({conversation_id:t,body:""}),u=d=>{d.preventDefault(),o.body.trim()&&i("/messages",{preserveScroll:!0,preserveState:!1,onSuccess:()=>c("body"),onFinish:()=>{l(),o.body!==""&&a("body",""),r.current.focus()}})};return s.jsxs("form",{className:"mi-form",onSubmit:u,autoComplete:"off",children:[s.jsx("input",{ref:r,className:"mi-input",name:"body",value:o.body,onChange:d=>a("body",d.target.value),placeholder:"Type a message…",autoComplete:"new-password"}),s.jsx("button",{className:"mi-send",type:"submit",disabled:e,children:"Send"})]})}function b({messages:t,currentUserId:r}){const o=n.useRef(null),a=n.useRef(null),i=()=>{const e=o.current;return e?e.scrollHeight-e.scrollTop-e.clientHeight<120:!0};return n.useEffect(()=>{i()&&a.current.scrollIntoView({behavior:"smooth"})},[t.data.length]),n.useEffect(()=>{a.current.scrollIntoView({behavior:"auto"})},[]),s.jsxs("div",{ref:o,className:"message-list",children:[t.data.map(e=>{const c=r&&e.user?.id===r;return s.jsxs("div",{className:`msg-item ${c?"me":"other"}`,children:[s.jsxs("div",{className:"msg-meta",children:[e.user?.name," • ",new Date(e.created_at).toLocaleString()]}),s.jsx("div",{className:"msg-bubble",children:e.body})]},e.id)}),s.jsx("div",{ref:a})]})}function y({conversation:t,messages:r,conversations:o=[]}){const[a,i]=n.useState(r.data);return n.useEffect(()=>i(r.data),[r]),n.useEffect(()=>{const e=window.Echo,l=`private-${`conversation.${t.id}`}`,u=e.private(l),d=m=>{i(f=>[...f,m.message])};return u.listen(".MessageCreated",d),()=>{u.stopListening(".MessageCreated"),e.leave(l)}},[t.id]),s.jsx(h,{sidebar:s.jsx(p,{conversations:o}),children:s.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[s.jsx("div",{style:{padding:"10px 16px",borderBottom:"1px solid #eee",background:"#fff"},children:s.jsx("strong",{children:t.name||(t.is_direct?"Direct message":`Group #${t.id}`)})}),s.jsx(b,{messages:{data:a},currentUserId:void 0}),s.jsx(x,{conversationId:t.id},t.id)]})})}export{y as default};
